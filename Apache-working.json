{
    "variables": {
        "region":         "us-east-2",
                "aws_subnet_id": "subnet-061b3cc8692d0ad8e",
        "aws_vpc_id": "vpc-0ff05aa62c74b34bc",
        "aws_ami_name": "packer-test-rhel-ami-{{timestamp}}"
    },
    "builders": [
        {
            "ami_name": "{{user `aws_ami_name`}}",   
   "instance_type": "t2.micro",
            "region": "us-east-2",


                        "source_ami_filter": {
    "filters": {
     "virtualization-type": "hvm",
     "name": "RHEL-Base-*",
     "root-device-type": "ebs"
    },
    "owners": [
     "014742839986"
    ],
    "most_recent": true
   },

            "vpc_id": "{{user `aws_vpc_id`}}",
            "subnet_id": "{{user `aws_subnet_id`}}",
                        "associate_public_ip_address": "true",
            "ssh_username": "ec2-user",
            "type": "amazon-ebs",
                        "communicator": "ssh"
        }
    ],
   "provisioners": [

         {
      "type": "shell",
 "inline": [
        "sudo yum -y update"
      ]
    },
{
 "type": "shell",
 "inline":  [
  "sudo yum -y install httpd"
]

},

{
  "type": "file",
  "source": "index.html",
  "destination": "/tmp/index.html"
},
{
  "type": "shell",
  "inline": "sudo cp /tmp/index.html /var/www/html/index.html"
},

{
  "type":"shell",
  "inline":[
  "sudo systemctl restart httpd"
]

}

  ]
}